import{e as j,a as w,u as b,r as d,j as s,c as E,d as O,b as N}from"./index-OLy-s8nC.js";import{v as S,a as v}from"./validaters-CcFLOBpK.js";import{O as F}from"./Card-ffu4qo4M.js";import{O as C,a as h,b as L}from"./FormMessage-C9hwLOhE.js";import"./Alert-DL7e4AUV.js";import"./shield-alert-pw1ISJiI.js";function V(){const{setUser:f,setRat:y}=j(),{n:k}=w(),{t:a}=b(),[t,p]=d.useState({username:"",password:""}),[u,c]=d.useState(!1),[o,n]=d.useState(null),g=()=>{const e={},r=S(t.username),i=v(t.password);return r&&(e.username=r),i&&(e.password=i),n({fields:e}),Object.keys(e).length===0},m=e=>{const{name:r,value:i}=e.target;p(l=>({...l,[r]:i})),o?.fields?.[r]&&n(l=>({...l,fields:{...l.fields,[r]:""}}))},x=async()=>{if(c(!0),n(null),!g()){c(!1);return}try{const e=await N.login(t);if(!e.ok)throw new Error(e.error||a("An error occurred"));y(e.token),f(e.user),k("home")}catch(e){n(()=>({message:e.message||a("An error occurred")}))}finally{c(!1)}};return s.jsx("section",{className:"oyk-page oyk-auth",children:s.jsxs("div",{className:"oyk-auth-container",children:[s.jsxs("div",{className:"oyk-auth-header",children:[s.jsx("h1",{className:"oyk-auth-header-title",children:a("Sign in to your account")}),s.jsxs("p",{className:"oyk-auth-header-subtitle",children:[a("Or")," ",s.jsx(E,{routeName:"register",className:"oyk-auth-header-subtitle",children:a("create a new account")})]})]}),s.jsx(F,{children:s.jsxs(C,{className:"oyk-auth-form",onSubmit:x,isLoading:u,children:[s.jsx(h,{label:a("Username"),name:"username",defaultValue:t.username,onChange:m,hasError:o?.fields?.username,required:!0,block:!0}),s.jsx(h,{label:a("Password"),name:"password",type:"password",defaultValue:t.password,onChange:m,hasError:o?.fields?.password,required:!0,block:!0}),o?.message&&s.jsx(L,{hasError:o?.message}),s.jsx("div",{className:"oyk-form-actions",children:s.jsx(O,{type:"submit",color:"primary",disabled:u,block:!0,children:a(u?"Signing in...":"Sign in")})})]})})]})})}export{V as default};
