import{a as g,u as b,r as f,j as e,c as x,d as j,b as E}from"./index-OLy-s8nC.js";import{v as P,a as C,b as N,c as O}from"./validaters-CcFLOBpK.js";import{O as v}from"./Card-ffu4qo4M.js";import{O as F,a as m,b as q}from"./FormMessage-C9hwLOhE.js";import"./Alert-DL7e4AUV.js";import"./shield-alert-pw1ISJiI.js";function A(){const{n:p}=g(),{t:n}=b(),[a,w]=f.useState({username:"",password:"",confirmPassword:"",email:"",name:""}),[c,u]=f.useState(!1),[o,d]=f.useState(null),y=()=>{const s={},r=P(a.username),i=C(a.password),t=N(a.email),h=O(a.name);return r&&(s.username=r),i&&(s.password=i),t&&(s.email=t),h&&(s.name=h),a.confirmPassword?a.password!==a.confirmPassword&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",d({fields:s}),Object.keys(s).length===0},l=s=>{const{name:r,value:i}=s.target;w(t=>({...t,[r]:i})),o?.fields?.[r]&&d(t=>({...t,fields:{...t.fields,[r]:""}}))},k=async s=>{if(u(!0),d(null),!y()){u(!1);return}try{const{confirmPassword:r,...i}=a;if(!(await E.post("/auth/register/",i)).ok)throw new Error;p("login")}catch(r){d(()=>({message:r.error||n("An error occurred")}))}finally{u(!1)}};return e.jsx("section",{className:"oyk-page oyk-auth",children:e.jsxs("div",{className:"oyk-auth-container",children:[e.jsxs("div",{className:"oyk-auth-header",children:[e.jsx("h1",{className:"oyk-auth-header-title",children:"Create an account"}),e.jsxs("p",{className:"oyk-auth-header-subtitle",children:["Or"," ",e.jsx(x,{routeName:"login",className:"oyk-auth-header-subtitle",children:"sign in to an existing account"})]})]}),e.jsx(v,{children:e.jsxs(F,{className:"oyk-auth-form",onSubmit:k,isLoading:c,children:[e.jsx(m,{label:n("Username"),name:"username",defaultValue:a.username,onChange:l,hasError:o?.fields?.username,required:!0,block:!0}),e.jsx(m,{label:n("Password"),name:"password",type:"password",defaultValue:a.password,onChange:l,hasError:o?.fields?.password,required:!0,block:!0}),e.jsx(m,{label:n("Confirm Password"),name:"confirmPassword",type:"password",defaultValue:a.confirmPassword,onChange:l,hasError:o?.fields?.confirmPassword,required:!0,block:!0}),e.jsx(m,{label:n("Email"),name:"email",type:"email",defaultValue:a.email,onChange:l,hasError:o?.fields?.email,required:!0,block:!0}),e.jsx(m,{label:n("Name"),name:"name",defaultValue:a.name,onChange:l,hasError:o?.fields?.name,required:!0,block:!0}),o?.message&&e.jsx(q,{hasError:o?.message}),e.jsx("div",{className:"oyk-form-actions",children:e.jsx(j,{type:"submit",color:"primary",disabled:c,block:!0,children:c?"Creating account...":"Create account"})})]})})]})})}export{A as default};
